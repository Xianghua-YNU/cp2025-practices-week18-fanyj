         
# 实验报告：链式反应模拟

**学生姓名：**范玉洁

**学号：**20221050183
**完成日期：**6.25

## 一、实验目的
参考《计算物理基础》8.8 节的MATLAB代码，编写链式反应模拟的python程序，实现链式反应的模拟逻辑，可视化反应过程，并分析不同参数对反应结果的影响。

## 二、实验原理
### 2.1 链式反应理论基础
阐述链式反应的基本概念、发生条件和主要过程，引用相关物理定律和公式。
可裂变物质存在：系统中包含足够浓度的可裂变核素（如235U）；​
中子有效增殖：每次裂变产生的中子数（增殖系数k）需满足k≥1，即中子产生率大于损耗率（吸收、泄漏）。
中子产生：裂变反应释放平均\(\nu\)个中子（如热中子诱发\({}^{235}\text{U}\)裂变时\(\nu\approx2.43\)）；
中子输运：中子通过扩散在介质中移动，遵循扩散方程\(J = -D\nabla\phi\)（\(J\)为中子流密度，\(D\)为扩散系数）；
反应概率：中子与原子核发生裂变、吸收或散射的概率由截面\(\sigma\)描述，反应率\(R = N\sigma v\phi\)（\(N\)为核子数密度，\(v\)为中子速度，\(\phi\)为中子通量）。
### 2.2 参考代码原理
简要说明《计算物理基础》8.8 节代码的核心逻辑和算法思路。
初始化：随机分布可裂变物质，设定初始中子位置；​
单步模拟：​
遍历每个网格点，处理中子的裂变、吸收和扩散；​
裂变时消耗可裂变物质，按概率生成新中子并扩散到相邻网格；​
吸收或散射时中子被移除或迁移；​
数据记录：跟踪可裂变物质总量和中子数随时间的变化。​
Python 实现中采用面向对象编程，将模拟参数、状态和操作封装在NuclearChainReaction类中，通过概率模型（如泊松分布模拟裂变中子数）和网格操作实现动态过程。
## 三、实验环境
### 3.1 硬件环境
处理器 AMD Ryzen 7 5800H with Radeon Graphics 3.20 GHz 机带 RAM 16.0 GB (15.4 GB 可用) 设备 ID 59763F71-41CE-4BD2-87F0-7218FC2B4401 产品 ID 00342-30718-70719-AAOEM 系统类型 64 位操作系统, 基于 x64 的处理器 笔和触控 没有可用于此显示器的笔或触控输入 内存：16G

3.2 软件环境 操作系统：Windows 11 家庭版 编程语言：Python 3.9.13 开发工具：NumPy 1.21.2（数值计算）、Matplotlib 3.4.3（数据可视化）


## 四、实验步骤
### 4.1 链式反应模拟逻辑实现
详细描述实现链式反应模拟逻辑的步骤，给出关键代码片段。
类初始化：​
定义网格大小size，初始可裂变物质比例initial_fissile（通过随机数生成网格）；​
初始化中子分布，随机放置initial_neutrons个中子。​
单步模拟（simulate_step方法）：​
遍历每个网格点，处理中子与可裂变物质的相互作用：​
裂变：若中子撞击可裂变物质且裂变概率fission_prob触发，消耗该物质，按泊松分布生成新中子并扩散（扩散概率diffusion）；​
吸收：中子以absorption_prob概率被吸收，否则扩散或留在原地；​
限制中子数不超过max_neutrons以避免计算过载。​
数据记录与可视化：​
记录每一步的可裂变物质总量和中子数，用于绘制趋势图；​
使用 Matplotlib 实现静态分布可视化和动态动画演示。
```python
# 中子与可裂变物质相互作用逻辑（simulate_step方法节选）
for i in range(self.size):
    for j in range(self.size):
        n = self.neutrons[i, j]
        if n == 0:
            continue
        for _ in range(n):
            if self.fissile[i, j] and np.random.rand() < self.fission_prob:
                fissions += 1
                self.fissile[i, j] = False
                new_n = np.random.poisson(self.reproduction)
                for _ in range(new_n):
                    if np.random.rand() < self.diffusion:
                        dx, dy = np.random.choice([-1, 0, 1], 2)
                        ni, nj = i + dx, j + dy
                        if 0 <= ni < self.size and 0 <= nj < self.size:
                            new_neutrons[ni, nj] += 1
                    else:
                        new_neutrons[i, j] += 1
            elif np.random.rand() < self.absorption_prob:
                continue
            else:
                if np.random.rand() < self.diffusion:
                    dx, dy = np.random.choice([-1, 0, 1], 2)
                    ni, nj = i + dx, j + dy
                    if 0 <= ni < self.size and 0 <= nj < self.size:
                        new_neutrons[ni, nj] += 1
                else:
                    new_neutrons[i, j] += 1
```
### 4.2 参数设置与实验运行
列出实验中设置的不同参数组合，描述如何改变参数并运行实验。
参数名称                   基础值         变化范围              实验目的
初始可裂变物质比例          0.3         0.2, 0.4, 0.5  观察燃料浓度对反应剧烈程度的影响   
裂变概率                    0.5          0.4, 0.6, 0.7  验证反应概率对中子增殖的影响
中子增殖率（reproduction）  2.5          2.0, 2.5, 3.0  分析中子产额对链式反应的维持作用
吸收概率                    0.1          0.05, 0.15, 0.2  研究中子损耗对反应衰减的影响



运行步骤​
修改run_simulation函数中的参数（如initial_fissile=0.4）；​
调用reactor.simulate(steps=50)运行指定时间步的模拟；​
使用reactor.visualize()生成静态可视化结果，或reactor.animate()观察动态过程；​
对比不同参数下的可裂变物质分布、中子数曲线，分析反应趋势变化。
![屏幕截图 2025-06-25 101246](https://github.com/user-attachments/assets/a27178e6-0edf-47b9-82e4-86ce2b31cd5d)

## 五、实验结论
总结实验结果，判断是否成功实现链式反应模拟和可视化，不同参数对反应结果的影响是否符合预期，提出改进实验的建议。

成功实现核心逻辑：程序准确模拟了中子的扩散、裂变和吸收过程，可裂变物质消耗与中子数动态变化符合链式反应的物理规律；​
可视化效果良好：静态图像清晰展示了物质分布和中子密度，动画直观呈现了反应的时空演化，便于观察链式反应的 “爆发” 或 “衰减” 过程。​
2. 参数影响分析​
初始可裂变物质比例：比例越高，可参与裂变的核素越多，中子增殖效率提升，反应更剧烈（如图示中initial_fissile=0.5时中子数峰值更高）；​
裂变概率与增殖率：二者增大均会促进链式反应，当增殖率
​
k>1
时反应可持续，
​
k<1
时逐渐衰减，符合理论预期；​
吸收概率：吸收概率增加会减少有效中子数，导致反应提前终止，验证了中子损耗对链式反应的抑制作用。​
3. 改进建议​
优化计算效率：当前网格遍历方法在大尺寸网格下计算耗时较长，可通过向量化操作（如 NumPy 矩阵运算）替代双重循环；​
扩展物理模型：增加中子能量分层、温度效应或慢化剂模拟，提升模型复杂度；​
参数敏感性分析：通过正交试验设计系统研究多参数耦合对反应结果的影响。​
总结​
本实验通过 Python 编程实现了链式反应的数值模拟，结合可视化工具验证了理论模型的正确性。不同参数对反应结果的影响与核物理基本规律一致，为进一步研究核反应堆动力学提供了基础框架。​

        
