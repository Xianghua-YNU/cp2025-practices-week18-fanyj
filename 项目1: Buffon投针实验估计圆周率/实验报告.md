
# 实验报告：Buffon 投针实验估计 $\pi$ 值

**学生姓名：** 范玉洁 

**学号：** 220221050183
**完成日期：** 6.25

## 一、实验目的
编写程序，利用 Buffon 投针实验来估计 $\pi$ 的值，并分析实验次数对估计精度的影响。

## 二、实验原理
简要描述 Buffon 投针实验的原理，包括投针概率与 $\pi$ 的关系公式。
Buffon 投针实验的核心思想是通过几何概率模型将 \(\pi\) 的求解转化为随机事件的频率统计问题。
模型假设：平面上有无限多条间距为 \(d\) 的平行直线，向平面随机投掷长度为 \(l\)（\(l \leq d\)）的针，针与直线相交的概率为 \(p\)。
概率公式：根据几何概率推导，相交概率 \(p = \frac{2l}{\pi d}\)，变形可得 \(\pi = \frac{2ln}{dm}\)，其中 \(n\) 为投针总次数，\(m\) 为相交次数。
估计逻辑：通过大量重复实验，统计相交次数 \(m\)，利用公式计算 \(\pi\) 的估计值，实验次数越多，估计值越接近真实值。
## 三、实验环境
### 3.1 硬件环境
处理器	AMD Ryzen 7 5800H with Radeon Graphics            3.20 GHz
机带 RAM	16.0 GB (15.4 GB 可用)
设备 ID	59763F71-41CE-4BD2-87F0-7218FC2B4401
产品 ID	00342-30718-70719-AAOEM
系统类型	64 位操作系统, 基于 x64 的处理器
笔和触控	没有可用于此显示器的笔或触控输入
内存：16G

### 3.2 软件环境
- 操作系统：Windows 11 家庭版
- 编程语言：Python 3.9.13
- 开发工具：NumPy 1.21.2（数值计算）、Matplotlib 3.4.3（数据可视化）

## 四、实验步骤
### 4.1 投针实验模拟逻辑实现
详细描述实现投针实验模拟逻辑的步骤，可附上关键代码片段。
```python
def simulate(self, num_trials: int) -> float:
    np.random.seed(42)  # 固定随机种子确保可复现
    y_center = np.random.uniform(0, self.line_distance/2, num_trials)
    theta = np.random.uniform(0, np.pi/2, num_trials)
    half_projection = (self.needle_length/2) * np.sin(theta)
    intersections = y_center <= half_projection  # 布尔数组表示是否相交
    num_hits = np.sum(intersections)
    if num_hits == 0:
        return 0  # 避免除零错误
    return (2 * self.needle_length * num_trials) / (self.line_distance * num_hits)
```
随机生成针的位置与角度：
针的中心到最近直线的垂直距离 \(y \sim U(0, d/2)\)（均匀分布）。
针与直线的夹角 \(\theta \sim U(0, \pi/2)\)（均匀分布，利用对称性简化计算）。
判断是否相交：
针的半长在垂直方向的投影为 \((l/2)\sin\theta\)，若 \(y \leq (l/2)\sin\theta\)，则针与直线相交。
统计相交次数：通过布尔运算快速统计相交次数 \(m\)，代入公式计算 \(\pi\) 估计值。
### 4.2 实验次数设置
说明实验中设置的不同实验次数，例如：100、1000、10000、100000 等。
置 5 组不同实验次数：[100, 1000, 10000, 100000, 1000000]，覆盖三个数量级
### 4.3 运行实验并记录结果
记录每次实验得到的 $\pi$ 估计值。
通过循环调用 simulate 方法，记录每组实验的 \(\pi\) 估计值及与真实值（\(\pi \approx 3.1415926536\)）的绝对误差。
## 五、实验结果
### 5.1 不同实验次数下的 $\pi$ 估计值
| 实验次数 | $\pi$ 估计值 |
|----------|---------------|
| 100      | 3.1830988618  |
| 1000     | 3.1375722380  |
| 10000    |3.1437466481  |
| 100000   |3.1411452110]  |
1000000      3.1416236624
### 5.2 实验结果可视化
附上不同实验次数与 $\pi$ 估计值的关系图表，可使用折线图或柱状图。
![实验结果图表]([填写图表路径])
![image](https://github.com/user-attachments/assets/11a61a41-6807-4f0e-bca4-0dbb465908a6)

## 六、结果分析
### 6.1 实验次数对估计精度的影响
分析随着实验次数的增加， $\pi$ 估计值的变化趋势，以及估计精度的变化情况。
趋势分析：随着实验次数从 \(10^2\) 增加到 \(10^6\)，\(\pi\) 估计值的波动范围逐渐缩小，从 \(3.18\)（100 次）收敛到 \(3.1416\)（100 万次），接近真实值。
精度量化：绝对误差从 \(0.0415\) 降至 \(0.00003\)，误差量级随次数增加呈 \(O(1/\sqrt{n})\) 下降，符合中心极限定理（统计误差与实验次数平方根成反比）。
### 6.2 误差来源分析
讨论实验中可能存在的误差来源，如随机数生成的质量、模拟逻辑的近似等。
随机数生成质量：伪随机数的均匀性和独立性会影响模拟精度，尽管使用高质量随机数生成器（NumPy 的 Mersenne Twister），仍存在微小偏差。
统计波动：小样本量（如 100 次）时，偶然因素导致相交次数偏离理论概率，产生较大误差。
几何近似：假设针为理想线段、直线无限延伸，实际模拟中通过有限区间截断可能引入边界效应（本实验设置线间距足够大，影响可忽略）。
七、实验结论
## 七、实验结论
总结实验结果，说明 Buffon 投针实验是否能够有效估计 $\pi$ 的值，以及实验次数对估计精度的影响是否符合预期。
方法有效性：Buffon 投针实验通过概率统计方法成功估计了 \(\pi\) 的值，验证了几何概率模型与数值模拟的结合可行性。
次数影响：实验次数越多，\(\pi\) 估计值越精确，误差随次数增加显著降低，符合大数定律和中心极限定理的预期。
局限性：该方法收敛速度较慢（需百万次以上实验才能达到四位有效数字精度），实际应用中更高效的数值算法（如蒙特卡洛改进方法）更为常用。

        
